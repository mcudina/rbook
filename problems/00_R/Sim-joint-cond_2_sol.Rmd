1. 
      The entry at $(i,j)$ of the distribution table for $(X,Y)$ contains, by definition, the
probability $\PP[ X=i \text{ and } Y=i]$. The possible values for $X = Z+W$ are
$-2,1,0,1,2$ and the possible values for $Y = Z W$ are $0$ and $1$ (note that
$Y$ cannot be $-1$!). To compute, e.g. $\PP[ X=1, Y=0]$ we look for all possible
combinations of the values of $Z,W$ with the property $Z+W = 1$ and $Z W =0$. It
turns out there are two possibilities, namely $Z = 0, W=1$ and $Z=1, W=0$.
Each of those comes with probability $0.1$, which means that $\PP[ X=1, Y=0] =
0.2$. We fill out the remaining entries in a similar way (rows correspond to values of $X$):

```{r echo=FALSE}
library(kableExtra)
probs = c(0.0, 0.2, 0.2, 0.2, 0.0, 0.2, 0.0, 0.0, 0.0, 0.2);
df = data.frame(matrix(probs, nrow=5))
colnames(df) = c("0","1")
rownames(df) = c("-2","-1", "0","1", "2")
kable(df, 
      # striped=TRUE, 
      row.names=TRUE) %>% 
column_spec(1, bold = T) %>%
kable_styling(full_width=FALSE)
```
   
   
      To compute $\EE[XY]$ we compute the value of the product $i j$ for each entry in
      the table above, multiply it by the probability there and sum the obtained
      results. The only non-zero terms are $1 \times (-2) \times 0.2$ and $1 \times 2
      \times 0.2$, so  $$ \EE[ XY ] = -2 \times 0.2 + 2 \times 0.2 = 0.$$ Finally, $$
      \PP[ X=0 | Y=0] = \frac{\PP[ X=0, Y=0]}{ \PP[ Y=0]} = \frac{ 0.2}{ 0.2 + 0.2 +
      0.2} = \frac{1}{3}.$$

2. We borrow the code from the notes to draw simulations from the distribution of $(W,Z)$, first:

   ```{r tidy=F}
   joint_distribution_long = data.frame(
      z = c(-1,-1,-1, 0,0,0, 1,1,1),
      w = c(-1,0,1, -1,0,1, -1,0,1) )
   probabilities_long = c(0.2,0.1,0.0,0.1,0.2,0.1,0.0,0.1,0.2);
   sampled_rows = sample(
      x = 1:nrow(joint_distribution_long),
      size = 10000,
      replace = TRUE,
      prob = probabilities_long )
   d_zw = joint_distribution_long[sampled_rows, ]
   ```

   Then we transform the results into $(X,Y)$ and output the table of relative frequencies:

   ```{r}
   draws_xy = data.frame(x = d_zw$z + d_zw$w,
                         y = d_zw$z  * d_zw$w)
   (cont_table = prop.table(table(draws_xy)))
   ```

   We build a matrix containing the probabilities we derived in 1. above and subtract it from `cont_table`:
   
   ```{r}
   prob_table = matrix(c(0.0, 0.2, 0.2, 0.2, 0.0, 0.2, 0.0, 0.0, 0.0, 0.2), nrow = 5);
   (error_table = cont_table - prob_table)
   ```
   
3. Monte Carlo:

   ```{r}
   mean( draws_xy$x * draws_xy$y)
   ```

4. First we remove all rows from `draws_xy` whose $y$-component is not $0$

   ```{r}
   draws_cond = draws_xy[ draws_xy$y == 0,] 
   ```

   Then we compute the relative frequency of the remaining draws where $x=0$:

   ```{r}
   ( est_prob = mean(draws_cond$x == 0) )
   ```
   The true value is $1/3$, so the error is given by
   
   ```{r}
   est_prob - 1/3
   ```

