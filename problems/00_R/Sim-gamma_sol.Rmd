 1.
    ```{r  echo=2:20, tidy = F}
    set.seed(1234)
    hist_with_pdf <- function(k, theta) {
      x = rgamma(10000, shape = k, scale = theta)
      hist(x, 
           probability = T,  
           breaks = 50, 
           xlim = c(0,15), ylim = c(0, 0.8),
           main = paste("shape = ", k, ", scale = ", theta)
           )
      x_pdf = seq(0, 15, by = 0.01)
      y_pdf = dgamma(x_pdf, shape = k, scale = theta)
      lines(x_pdf, y_pdf,
            type = "l",
            col = "red",
            lwd = 2)
    }
   
    par(mfrow = c(2, 2))  
    hist_with_pdf(2,1)
    hist_with_pdf(2,0.5)
    hist_with_pdf(3,1)
    hist_with_pdf(3,0.5)
    
    
    ```


 2. 
    We use Monte Carlo to estimate the probability:

    ```{r}
    x = rgamma(10000, shape = 2, scale = 1)
    y1 = rnorm(10000)
    y2 = rnorm(10000)
    z = x  > y1^2 + y2^2
    mean(z)
    ```

    and the permuation test to check for (in)dependence 

    ```{r fig.height = 5, echo=2:10}
    par(mar = c(2, 2, 2, 2))
    w = x*y1
    z = x*y2 
    par(mfrow = c(2, 2))
    z_perm_1 = sample(z)
    z_perm_2 = sample(z)
    z_perm_3 = sample(z)
    plot(w, z)
    plot(w, z_perm_1)
    plot(w, z_perm_2)
    plot(w, z_perm_3)
    ```


    The common shape of plots 2, 3. and 4. is sufficiently different from the shape
    of plot 1. to conclude that $XY_1$ and $XY_2$ are most likely not independent.
    Note: if you were to compute the correlation between $XY_1$ and $XY_2$ you would
    get $0$ - this is an example of uncorrelated random variables that are,
    nevertheless, not independent.

 3. First, we simulate $10,000$ draws from the distribution of $S = X + Y + Z$ and plot 
 the histogram of obtained values:

    ```{r}
    nsim = 10000
    x = rgamma( nsim, shape = 1, scale = 1)
    y = rgamma( nsim, shape = 2, scale = 1)
    z = rgamma( nsim, shape = 3, scale = 1)
    s = x + y + z
    hist(s, breaks = 100)
    ```
    The shape resembles the shape we obtained in 1. above, so we try the gamma distribution with various parameters.
    The function `try_parameters` below does exacly that - it superimposes the gamma pdf onto the histogram of `s`. 
    ```{r fig.height=6, echo=2:10}
    par(mar = c(2, 4, 4, 2))
    try_parameters = function (k, theta) {
      hist(s,
           probability = T,
           breaks = 50, 
           main = paste("Trying shape = ", k, " scale = ", theta)
      )
      x_pdf = seq(0, 15, by = 0.01)
      y_pdf = dgamma(x_pdf, k, theta)
      lines(x_pdf,
            y_pdf,
            type = "l",
            col = "red",
            lwd = 2)
    }

    par(mfrow = c(3, 3))
    try_parameters(1, 1)
    try_parameters(2, 1)
    try_parameters(1, 2)
    try_parameters(1, 3)
    try_parameters(2, 1)
    try_parameters(4, 1)
    try_parameters(8, 1)
    try_parameters(6, 1)
    try_parameters(7, 1)
    

    ```
We conclude that $X+Y+Z$ is most likely gamma-distributed with $k=6$ and
$\theta=1$. This is indeed, the case. The sum of independen gammas with shape
parameters $k_1, \dots, k_n$ and the same scale parameter $\theta$ is a gamma
with parameters $k = k_1+\dots+k_n$ and $\theta$.

