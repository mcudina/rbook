Let us start by writing a function to save some keystrokes


```{r}
permutation_test = function (z,w) {
   par(mfrow= c(2,2))
   plot(z,w, asp=1)
   plot(z,sample(w), asp=1)
   plot(z,sample(w), asp=1)
   plot(z,sample(w), asp=1)
}

x = rnorm(1000)
y = rnorm(1000)
```


a)
   ```{r fig.width = 8, fig.height = 8}
   permutation_test(x^2+y^2, y^2)
   ```

   The first plot is very different from the other three. Therefore,the vectors are probably *not* independent. 

b) 

   ```{r fig.width = 8, fig.height = 8}
   permutation_test((x+y)/sqrt(2), (x-y)/sqrt(2))
   ```

   The first plot could easily be confused for one of the other three. Therefore the vectors are probably independent. 


c)

   ```{r fig.width = 8, fig.height = 8}
   # we have to use rep(1,length(x)) 
   # to get a vector of 1s of the same length as x.
   # R will not recycle it properly if you simply write 1.
   # Another, more "hacky" way would be to take advantage of
   # recycling and use 0*x+1
   permutation_test(x,rep(1,length(x)))
   ```

   The plots look very similar. Therefore, the vectors are probably independent. We could have known this without drawing any graphs. Anything is independent of a constant random variable (vector).

d)

   ```{r fig.width = 8, fig.height = 8}
   permutation_test(x^2+y^2, atan(y/x) )
   ```


   Plots look very similar to each other. Therefore, `z` and `w` are probably independent. 

*Note:* The plots in b) and d) reveal that the distribution of the random vector
$(X,Y)$ consisting of two independent standard normals is probably rotation
invariant. In b) we are asked to compare the coordinates of the vector obtained
from $(X,Y)$ by a rotation at $45$ degrees around the origin. The fact that
independence persisted suggests that  components remain independent even after a
(specific) rotation. If you tried  rotations by different angles you would get
the same result. The experiment in d) told us that the (squared) distance
$X^2+Y^2$ and angle between $(X,Y)$ and the $x$-are independent. This is also
something that one would expect from a rotationally-invariant distribution.
Indeed, the distribution of the distance to the origin should not depend on the
direction.

It is important to note that none of this proves anything. It is simply
numerical evidence for a given conclusion.

