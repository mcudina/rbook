1. 
    We draw the $x$, $y$ and $z$ coordinates independet of each other, and uniformly  in $[-1,1]$. Then we discard those simulatione where the sum of the squares is $>1$:
  
    ```{r}
    nsim = 10000
    x_cube = runif(nsim, min = -1, max = 1)
    y_cube = runif(nsim, min = -1, max = 1)
    z_cube = runif(nsim, min = -1, max = 1)
    
    in_ball = x_cube^2+y_cube^2+z_cube^2 <= 1
    
    x = x_cube[in_ball]
    y = y_cube[in_ball]
    z = z_cube[in_ball]
    ```


2. 
    By Monte Carlo

    ```{r}
    W = sqrt(x^2 + y^2 + z^2)
    mean(W)
    sd(W)
    ```

    Note that the mean is not half the radius, i.e. $0.5$. Why?

3. 
    We add two new variables, $d1$ and $d2$ - distances to $(1,-1,1)$ and $(1,-1,-1)$, respectively:
    ```{r}
    d1 = sqrt((x-1)^2+(y+1)^2+(z-1)^2)
    d2 = sqrt((x-1)^2+(y+1)^2+(z+1)^2)
    condition = d1 < d2
    W_cond = W[condition]
    hist(W_cond, breaks = 50, probability = T)
    
    ```
    
4. 
    The main difficulty in this part of the problem is getting simulations from the uniform 
    distributions on the sphere. One possibility is to use the rejection method, and
    proceed as in part 1., but keep only those points for which $$1-\varepsilon <
    \sqrt{x^2+y^2+z^2} < 1+\varepsilon$$ for some (small) $\varepsilon$. There is a more 
    efficient method, though, and it does not involve any new simulations. We simply
    take our uniformly distributed points inside the unit ball and project each one onto
    the sphere, i.e. replace it by the closest point on the surface. This is easily
    achieved since the projection of the point $(x,y,z)$ is
    $$\Big( 
    \frac{x}{\sqrt{x^2+y^2+z^2}},
    \frac{y}{\sqrt{x^2+y^2+z^2}},
    \frac{y}{\sqrt{x^2+y^2+z^2}},
    \Big).$$
    
    A moment's though will convince you that those points indeed cover the sphere uniformly (no direction is preferred!).
    
    Since we already have the distance to the origin stored in the variable `W`, the code will be 
    extremely simple:
    
    ```{r}
    x_s = x/W
    y_s = y/W
    z_s = z/W
    ```
    
    The rest now parallels what happened in 2.
    
    ```{r}
    d1 = sqrt((x_s-1)^2+(y_s+1)^2+(z_s-1)^2)
    d2 = sqrt((x_s-1)^2+(y_s+1)^2+(z_s+1)^2)
    condition = d1 < d2
    
    W1 = sqrt( (x-1)^2+(y-1)^2+(z-1)^2 )
    W1_cond = W1[condition]
    hist(W1_cond, breaks = 50, probability = T)
    ```
    
  
  